//todo have a clean pseudocode algorithm here
